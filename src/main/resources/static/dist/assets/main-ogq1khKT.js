var f=Object.defineProperty;var v=(n,t,e)=>t in n?f(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var s=(n,t,e)=>v(n,typeof t!="symbol"?t+"":t,e);function L(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}class y{constructor(t={}){s(this,"routes",new Map);s(this,"popupHandlers",new Map);s(this,"popupStack",[]);s(this,"defaultRoute",null);s(this,"notFoundHandler",null);window.addEventListener("popstate",this.handlePopState.bind(this)),window.addEventListener("load",this.handleInitialRoute.bind(this)),t.defaultRoute&&(this.defaultRoute=t.defaultRoute),t.notFoundHandler&&(this.notFoundHandler=t.notFoundHandler),document.readyState==="complete"&&this.handleInitialRoute()}route(t,e){return this.routes.set(t,e),this}setDefaultRoute(t){return this.defaultRoute=t,this}setNotFoundHandler(t){return this.notFoundHandler=t,this}registerPopup(t,e){return this.popupHandlers.set(t,e),this}navigate(t,e={}){this.closeAllPopups(!1),history.pushState({type:"page",path:t,data:e},"",t),this.renderCurrentPath()}openPopup(t,e={}){if(!this.popupHandlers.has(t)){console.error("Popup handler not found for: ".concat(t));return}const o=window.location.pathname,a=new URL(window.location.href),p={id:t,data:e,openedAt:new Date().toISOString()};this.popupStack.push(p),a.searchParams.set("popup",t),Object.keys(e).length>0&&a.searchParams.set("data",btoa(JSON.stringify(e))),history.pushState({type:"popup",popup:p,stack:[...this.popupStack],path:o},"",a.toString()),this.renderPopup(p)}closePopup(t=!0){if(this.popupStack.length===0)return;const e=this.popupStack.pop();if(t)history.back();else{this.updatePopupUI();const o=this.popupHandlers.get(e.id);o&&o.onClose&&o.onClose(e.data)}}closeAllPopups(t=!0){if(this.popupStack.length!==0)if(t){const e=this.popupStack.length;history.go(-e)}else{for(;this.popupStack.length>0;){const e=this.popupStack.pop(),o=this.popupHandlers.get(e.id);o&&o.onClose&&o.onClose(e.data)}this.updatePopupUI()}}refresh(){(history.state||{}).type==="popup"?this.updatePopupUI():this.renderCurrentPath()}handlePopState(t){const e=t.state||{};e.stack?this.popupStack=e.stack:this.popupStack=[],e.type==="popup"?this.updatePopupUI():this.renderCurrentPath()}handleInitialRoute(){const t=new URL(window.location.href),e=t.searchParams.get("popup");if(e&&this.popupHandlers.has(e)){let o={};const a=t.searchParams.get("data");if(a)try{o=JSON.parse(atob(a))}catch(c){console.error("Failed to parse popup data",c)}const p={id:e,data:o,openedAt:new Date().toISOString()};this.popupStack=[p],history.replaceState({type:"popup",popup:p,stack:this.popupStack,path:window.location.pathname},"",window.location.href),this.renderCurrentPath(),this.renderPopup(p)}else this.renderCurrentPath()}renderCurrentPath(){var o;const t=window.location.pathname,e=this.routes.get(t);document.querySelectorAll(".spa-popup").forEach(a=>{a.style.display="none"}),e?e(t,((o=history.state)==null?void 0:o.data)||{}):this.notFoundHandler?this.notFoundHandler(t,{}):this.defaultRoute?this.defaultRoute(t,{}):console.error("No handler found for path: ".concat(t))}renderPopup(t){const e=this.popupHandlers.get(t.id);e&&(e.onOpen&&e.onOpen(t.data),this.updatePopupUI())}updatePopupUI(){document.querySelectorAll(".spa-popup").forEach(t=>{t.style.display="none"}),this.popupStack.forEach((t,e)=>{const o=this.popupHandlers.get(t.id);if(!o||!o.element)return;const a=o.element;a.style.display="block",a.style.zIndex="".concat(1e3+e),o.onUpdate&&o.onUpdate(t.data)})}}const b="/resources/assets/typescript-EnIy2PE5.svg",h="/resources/vite.svg",i=new y,d=new Map;d.set("Apple",1.99);d.set("Banana",.99);d.set("Orange",2.49);d.set("Mango",3.99);const S={Carrot:1.49,Broccoli:2.99,Spinach:3.49},P=new Map(Object.entries(S)),r=new Map([...d,...P]);document.body.innerHTML='\n  <div id="app-container">\n    <div id="page-container"></div>\n    \n    <!-- Popups -->\n    <div id="product-details-popup" class="spa-popup">\n      <div class="popup-content">\n        <div class="popup-header">\n          <h2 id="popup-product-name">Product Details</h2>\n          <button class="close-button">×</button>\n        </div>\n        <div class="popup-body">\n          <p id="popup-product-price"></p>\n          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla facilisi.</p>\n        </div>\n      </div>\n    </div>\n    \n    <div id="settings-popup" class="spa-popup">\n      <div class="popup-content">\n        <div class="popup-header">\n          <h2>Settings</h2>\n          <button class="close-button">×</button>\n        </div>\n        <div class="popup-body">\n          <h3>Theme</h3>\n          <select>\n            <option>Light</option>\n            <option>Dark</option>\n            <option>System</option>\n          </select>\n          <h3>Language</h3>\n          <select>\n            <option>English</option>\n            <option>Korean</option>\n            <option>Spanish</option>\n          </select>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Bottom Navigation -->\n    <nav id="bottom-nav">\n      <button class="nav-btn" data-path="/">Home</button>\n      <button class="nav-btn" data-path="/products">Products</button>\n      <button class="nav-btn" data-path="/about">About</button>\n      <button id="settings-btn">Settings</button>\n    </nav>\n  </div>\n';const g=document.createElement("style");g.textContent="\n  body {\n    margin: 0;\n    padding: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  }\n  \n  #app-container {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    max-width: 100%;\n    overflow-x: hidden;\n  }\n  \n  #page-container {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    padding-bottom: 80px; /* Space for bottom nav */\n  }\n  \n  .page-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n  }\n  \n  .page-header img {\n    height: 30px;\n    margin-right: 10px;\n  }\n  \n  .product-item {\n    padding: 15px;\n    margin-bottom: 10px;\n    border-radius: 8px;\n    background-color: #f8f9fa;\n    border-left: 4px solid #0095ff;\n    display: flex;\n    justify-content: space-between;\n  }\n  \n  /* Bottom navigation */\n  #bottom-nav {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    background-color: #fff;\n    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n    z-index: 100;\n  }\n  \n  .nav-btn {\n    flex: 1;\n    padding: 15px 5px;\n    border: none;\n    background: none;\n    font-size: 14px;\n    color: #666;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  \n  .nav-btn.active {\n    color: #0095ff;\n    font-weight: bold;\n  }\n  \n  /* Popup styles */\n  .spa-popup {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.5);\n    display: none;\n    justify-content: center;\n    align-items: flex-end;\n    z-index: 1000;\n  }\n  \n  .popup-content {\n    background: white;\n    width: 100%;\n    max-height: 80%;\n    border-radius: 12px 12px 0 0;\n    overflow: hidden;\n    animation: slide-up 0.3s ease-out;\n  }\n  \n  .popup-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 16px;\n    border-bottom: 1px solid #eee;\n  }\n  \n  .popup-body {\n    padding: 20px;\n    overflow-y: auto;\n  }\n  \n  .close-button {\n    border: none;\n    background: none;\n    font-size: 24px;\n    cursor: pointer;\n  }\n  \n  @keyframes slide-up {\n    from { transform: translateY(100%); }\n    to { transform: translateY(0); }\n  }\n";document.head.appendChild(g);i.route("/",(n,t)=>{var e;document.querySelector("#page-container").innerHTML='\n    <div class="page-header">\n      <img src="'.concat(h,'" alt="Vite logo" />\n      <h1>Home</h1>\n    </div>\n    <p>Welcome to our mobile app example using SpaNavigator!</p>\n    \n    <h2>Featured Products</h2>\n    <div class="product-item" data-product="Apple">\n      <span>Apple</span>\n      <span>$1.99</span>\n    </div>\n    <div class="product-item" data-product="Carrot">\n      <span>Carrot</span>\n      <span>$1.49</span>\n    </div>\n    \n    <h2>Today\'s Special</h2>\n    <div class="product-item special" data-product="Banana">\n      <span>Banana</span>\n      <span>$0.99 <small>20% OFF!</small></span>\n    </div>\n    \n    <!-- New Button Added -->\n    <div style="margin-top: 30px; text-align: center;">\n      <button id="show-random-product" style="background-color: #0095ff; color: white;">\n        Show Random Product Price\n      </button>\n    </div>\n  '),(e=document.querySelector("#show-random-product"))==null||e.addEventListener("click",()=>{var l;const o=Array.from(r.keys()),a=Math.floor(Math.random()*o.length),p=o[a],c=(l=r==null?void 0:r.get(p))!=null?l:"Price not available";alert("Random Product: ".concat(p!=null?p:"Unknown Product","\nPrice: $").concat(c))}),u("/"),m()});i.route("/products",(n,t)=>{const e=Array.from(r.entries()).map(([o,a])=>'\n      <div class="product-item" data-product="'.concat(o,'">\n        <span>').concat(o,"</span>\n        <span>$").concat(a,"</span>\n      </div>\n    ")).join("");document.querySelector("#page-container").innerHTML='\n    <div class="page-header">\n      <img src="'.concat(b,'" alt="TypeScript logo" />\n      <h1>Products</h1>\n    </div>\n    <p>Browse our catalog of fresh products:</p>\n    \n    <div id="products-list">\n      ').concat(e,"\n    </div>\n  "),u("/products"),m()});i.route("/about",(n,t)=>{document.querySelector("#page-container").innerHTML='\n    <div class="page-header">\n      <img src="'.concat(h,'" alt="Vite logo" />\n      <h1>About</h1>\n    </div>\n    <p>This is a simple SPA example using custom router with history API integration.</p>\n    <p>Features demonstrated:</p>\n    <ul>\n      <li>Page navigation with history support</li>\n      <li>Mobile-friendly popup system</li>\n      <li>Map and Set usage for data management</li>\n    </ul>\n    <p>Built with Vite and TypeScript, optimized for iOS 12+</p>\n  '),u("/about")});i.setNotFoundHandler((n,t)=>{var e;document.querySelector("#page-container").innerHTML='\n    <h1>Page Not Found</h1>\n    <p>The path "'.concat(n,'" doesn\'t exist.</p>\n    <button id="back-home">Back to Home</button>\n  '),(e=document.querySelector("#back-home"))==null||e.addEventListener("click",()=>{i.navigate("/")})});const x={element:document.querySelector("#product-details-popup"),onOpen:n=>{document.querySelector("#popup-product-name").textContent=n.name,document.querySelector("#popup-product-price").textContent="Price: $".concat(n.price)},onClose:()=>{console.log("Product details popup closed")}},w={element:document.querySelector("#settings-popup"),onOpen:n=>{console.log("Settings opened")}};i.registerPopup("product-details",x);i.registerPopup("settings",w);function k(){var n;document.querySelectorAll(".nav-btn").forEach(t=>{t.addEventListener("click",e=>{const o=e.currentTarget.dataset.path;o&&i.navigate(o)})}),(n=document.querySelector("#settings-btn"))==null||n.addEventListener("click",()=>{i.openPopup("settings",{})}),document.querySelectorAll(".close-button").forEach(t=>{t.addEventListener("click",()=>{i.closePopup()})})}function u(n){document.querySelectorAll(".nav-btn").forEach(t=>{t.dataset.path===n?t.classList.add("active"):t.classList.remove("active")})}function m(){document.querySelectorAll(".product-item").forEach(n=>{n.addEventListener("click",t=>{const e=t.currentTarget.dataset.product;if(e){const o=r.get(e)||0;i.openPopup("product-details",{name:e,price:o})}})})}k();i.navigate("/");export{L as __vite_legacy_guard};
