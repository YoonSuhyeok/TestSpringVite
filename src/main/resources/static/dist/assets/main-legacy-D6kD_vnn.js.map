{"version":3,"file":"main-legacy-D6kD_vnn.js","sources":["../../../../../../src-frontend/src/spa-navigator.ts","../../../../../../src-frontend/src/typescript.svg","../../../../../../../../../../vite.svg","../../../../../../src-frontend/src/main.ts"],"sourcesContent":["/**\n * SPA 네비게이션 라이브러리\n * 페이지 이동과 팝업을 히스토리 API와 통합하여 관리\n */\nexport class SpaNavigator {\n    private routes: Map<string, RouteHandler> = new Map();\n    private popupHandlers: Map<string, PopupHandler> = new Map();\n    private popupStack: PopupState[] = [];\n    private defaultRoute: RouteHandler | null = null;\n    private notFoundHandler: RouteHandler | null = null;\n    \n    constructor(options: SpaNavigatorOptions = {}) {\n      // 브라우저 이벤트 리스너 등록\n      window.addEventListener('popstate', this.handlePopState.bind(this));\n      window.addEventListener('load', this.handleInitialRoute.bind(this));\n      \n      // 옵션 적용\n      if (options.defaultRoute) this.defaultRoute = options.defaultRoute;\n      if (options.notFoundHandler) this.notFoundHandler = options.notFoundHandler;\n      \n      // 앱 초기화\n      if (document.readyState === 'complete') {\n        this.handleInitialRoute();\n      }\n    }\n    \n    /**\n     * 경로에 대한 핸들러 등록\n     */\n    route(path: string, handler: RouteHandler): SpaNavigator {\n      this.routes.set(path, handler);\n      return this;\n    }\n    \n    /**\n     * 기본 경로 핸들러 등록\n     */\n    setDefaultRoute(handler: RouteHandler): SpaNavigator {\n      this.defaultRoute = handler;\n      return this;\n    }\n    \n    /**\n     * 404 페이지 핸들러 등록\n     */\n    setNotFoundHandler(handler: RouteHandler): SpaNavigator {\n      this.notFoundHandler = handler;\n      return this;\n    }\n    \n    /**\n     * 팝업 핸들러 등록\n     */\n    registerPopup(popupId: string, handler: PopupHandler): SpaNavigator {\n      this.popupHandlers.set(popupId, handler);\n      return this;\n    }\n    \n    /**\n     * 페이지 이동\n     */\n    navigate(path: string, data: any = {}): void {\n      // 모든 팝업 닫기\n      this.closeAllPopups(false);\n      \n      // 새 페이지로 이동\n      history.pushState({ \n        type: 'page', \n        path,\n        data \n      }, '', path);\n      \n      this.renderCurrentPath();\n    }\n    \n    /**\n     * 팝업 열기\n     */\n    openPopup(popupId: string, data: any = {}): void {\n      if (!this.popupHandlers.has(popupId)) {\n        console.error(`Popup handler not found for: ${popupId}`);\n        return;\n      }\n      \n      const currentPath = window.location.pathname;\n      const url = new URL(window.location.href);\n      \n      // 현재 팝업 스택에 추가\n      const popupState: PopupState = { \n        id: popupId, \n        data,\n        openedAt: new Date().toISOString()\n      };\n      this.popupStack.push(popupState);\n      \n      // 팝업 상태를 URL 쿼리에 추가\n      url.searchParams.set('popup', popupId);\n      if (Object.keys(data).length > 0) {\n        url.searchParams.set('data', btoa(JSON.stringify(data)));\n      }\n      \n      // 히스토리에 팝업 상태 추가\n      history.pushState({\n        type: 'popup', \n        popup: popupState, \n        stack: [...this.popupStack],\n        path: currentPath\n      }, '', url.toString());\n      \n      // 팝업 렌더링\n      this.renderPopup(popupState);\n    }\n    \n    /**\n     * 팝업 닫기\n     */\n    closePopup(navigate: boolean = true): void {\n      if (this.popupStack.length === 0) return;\n      \n      const popup = this.popupStack.pop()!;\n      \n      if (navigate) {\n        // 히스토리 뒤로가기로 팝업 닫기\n        history.back();\n      } else {\n        // 히스토리 변경 없이 UI만 업데이트\n        this.updatePopupUI();\n        \n        // 팝업 닫힘 이벤트 발생\n        const handler = this.popupHandlers.get(popup.id);\n        if (handler && handler.onClose) {\n          handler.onClose(popup.data);\n        }\n      }\n    }\n    \n    /**\n     * 모든 팝업 닫기\n     */\n    closeAllPopups(navigate: boolean = true): void {\n      if (this.popupStack.length === 0) return;\n      \n      if (navigate) {\n        // 팝업 스택 깊이만큼 뒤로가기\n        const depth = this.popupStack.length;\n        history.go(-depth);\n      } else {\n        // 스택에서 모든 팝업 제거\n        while (this.popupStack.length > 0) {\n          const popup = this.popupStack.pop()!;\n          const handler = this.popupHandlers.get(popup.id);\n          if (handler && handler.onClose) {\n            handler.onClose(popup.data);\n          }\n        }\n        \n        // UI 업데이트\n        this.updatePopupUI();\n      }\n    }\n    \n    /**\n     * 페이지 새로고침\n     */\n    refresh(): void {\n      const state = history.state || {};\n      \n      if (state.type === 'popup') {\n        // 팝업 상태 새로고침\n        this.updatePopupUI();\n      } else {\n        // 현재 페이지 다시 렌더링\n        this.renderCurrentPath();\n      }\n    }\n    \n    /**\n     * 뒤로가기 이벤트 처리\n     */\n    private handlePopState(event: PopStateEvent): void {\n      const state = event.state || {};\n      \n      // 팝업 스택 복원\n      if (state.stack) {\n        this.popupStack = state.stack;\n      } else {\n        this.popupStack = [];\n      }\n      \n      if (state.type === 'popup') {\n        // 팝업 상태로 UI 업데이트\n        this.updatePopupUI();\n      } else {\n        // 일반 페이지 렌더링\n        this.renderCurrentPath();\n      }\n    }\n    \n    /**\n     * 초기 경로 처리\n     */\n    private handleInitialRoute(): void {\n      const url = new URL(window.location.href);\n      const popupId = url.searchParams.get('popup');\n      const path = window.location.pathname;\n      \n      if (popupId && this.popupHandlers.has(popupId)) {\n        // Restore popup data from URL if available\n        let popupData = {};\n        const encodedData = url.searchParams.get('data');\n        if (encodedData) {\n          try {\n            popupData = JSON.parse(atob(encodedData));\n          } catch (e) {\n            console.error('Failed to parse popup data from URL', e);\n          }\n        }\n        \n        // Create popup state\n        const popupState: PopupState = {\n          id: popupId,\n          data: popupData,\n          openedAt: new Date().toISOString()\n        };\n        \n        // Add to stack and update history state\n        this.popupStack = [popupState];\n        history.replaceState({\n          type: 'popup',\n          popup: popupState,\n          stack: this.popupStack,\n          path: path\n        }, '', url.toString());\n        \n        // Render the current path first\n        this.renderCurrentPath();\n        \n        // Then render the popup\n        this.renderPopup(popupState);\n      } else {\n        // Regular path handling (unchanged)\n        history.replaceState({\n          type: 'page',\n          path: path,\n          data: {}\n        }, '', window.location.href);\n        \n        this.renderCurrentPath();\n      }\n    }\n    \n    /**\n     * 현재 경로에 맞는 페이지 렌더링\n     */\n    private renderCurrentPath(): void {\n      const path = window.location.pathname;\n      const handler = this.routes.get(path);\n      \n      // 모든 팝업 요소 숨기기\n      document.querySelectorAll('.spa-popup').forEach(popup => {\n        (popup as HTMLElement).style.display = 'none';\n      });\n      \n      if (handler) {\n        // 경로 핸들러 실행\n        handler(path, history.state?.data || {});\n      } else if (this.notFoundHandler) {\n        // 404 핸들러 실행\n        this.notFoundHandler(path, {});\n      } else if (this.defaultRoute) {\n        // 기본 핸들러 실행\n        this.defaultRoute(path, {});\n      } else {\n        console.error(`No handler found for path: ${path}`);\n      }\n    }\n    \n    /**\n     * 팝업 렌더링\n     */\n    private renderPopup(popupState: PopupState): void {\n      const handler = this.popupHandlers.get(popupState.id);\n      if (!handler) return;\n      \n      if (handler.onOpen) {\n        handler.onOpen(popupState.data);\n      }\n      \n      this.updatePopupUI();\n    }\n    \n    /**\n     * 팝업 UI 업데이트\n     */\n    private updatePopupUI(): void {\n      // 모든 팝업 숨기기\n      document.querySelectorAll('.spa-popup').forEach(popup => {\n        (popup as HTMLElement).style.display = 'none';\n      });\n      \n      // 현재 스택의 팝업들 표시\n      this.popupStack.forEach((popup, index) => {\n        const handler = this.popupHandlers.get(popup.id);\n        if (!handler || !handler.element) return;\n        \n        const element = handler.element;\n        element.style.display = 'block';\n        \n        // z-index 설정 (스택 순서대로)\n        element.style.zIndex = `${1000 + index}`;\n        \n        // 팝업 데이터 업데이트\n        if (handler.onUpdate) {\n          handler.onUpdate(popup.data);\n        }\n      });\n    }\n  }\n  \n  // 타입 정의\n  export type RouteHandler = (path: string, data: any) => void;\n  \n  export interface PopupHandler {\n    element: HTMLElement;\n    onOpen?: (data: any) => void;\n    onUpdate?: (data: any) => void;\n    onClose?: (data: any) => void;\n  }\n  \n  export interface PopupState {\n    id: string;\n    data: any;\n    openedAt: string;\n  }\n  \n  export interface SpaNavigatorOptions {\n    defaultRoute?: RouteHandler;\n    notFoundHandler?: RouteHandler;\n  }","export default \"__VITE_ASSET__CuHqba4B__\"","export default \"__VITE_PUBLIC_ASSET__d6945b69__\"","import './style.css'\nimport { SpaNavigator, PopupHandler } from './spa-navigator'\nimport typescriptLogo from './typescript.svg'\nimport viteLogo from '/vite.svg'\n\n// Initialize SPA Navigator\nconst navigator = new SpaNavigator();\n\n// Create a Map with some data (for product pages)\nconst fruitPrices = new Map<string, number>();\nfruitPrices.set('Apple', 1.99);\nfruitPrices.set('Banana', 0.99);\nfruitPrices.set('Orange', 2.49);\nfruitPrices.set('Mango', 3.99);\n\nconst veggiePricesObj = {\n  Carrot: 1.49,\n  Broccoli: 2.99,\n  Spinach: 3.49\n};\nconst veggiePrices = new Map<string, number>(Object.entries(veggiePricesObj));\n\n// All products\nconst allProducts = new Map<string, number>([...fruitPrices, ...veggiePrices]);\n\n// Create app container\ndocument.body.innerHTML = `\n  <div id=\"app-container\">\n    <div id=\"page-container\"></div>\n    \n    <!-- Popups -->\n    <div id=\"product-details-popup\" class=\"spa-popup\">\n      <div class=\"popup-content\">\n        <div class=\"popup-header\">\n          <h2 id=\"popup-product-name\">Product Details</h2>\n          <button class=\"close-button\">×</button>\n        </div>\n        <div class=\"popup-body\">\n          <p id=\"popup-product-price\"></p>\n          <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nulla facilisi.</p>\n        </div>\n      </div>\n    </div>\n    \n    <div id=\"settings-popup\" class=\"spa-popup\">\n      <div class=\"popup-content\">\n        <div class=\"popup-header\">\n          <h2>Settings</h2>\n          <button class=\"close-button\">×</button>\n        </div>\n        <div class=\"popup-body\">\n          <h3>Theme</h3>\n          <select>\n            <option>Light</option>\n            <option>Dark</option>\n            <option>System</option>\n          </select>\n          <h3>Language</h3>\n          <select>\n            <option>English</option>\n            <option>Korean</option>\n            <option>Spanish</option>\n          </select>\n        </div>\n      </div>\n    </div>\n    \n    <!-- Bottom Navigation -->\n    <nav id=\"bottom-nav\">\n      <button class=\"nav-btn\" data-path=\"/\">Home</button>\n      <button class=\"nav-btn\" data-path=\"/products\">Products</button>\n      <button class=\"nav-btn\" data-path=\"/about\">About</button>\n      <button id=\"settings-btn\">Settings</button>\n    </nav>\n  </div>\n`;\n\n// Add mobile-friendly styles\nconst styleSheet = document.createElement(\"style\");\nstyleSheet.textContent = `\n  body {\n    margin: 0;\n    padding: 0;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  }\n  \n  #app-container {\n    display: flex;\n    flex-direction: column;\n    height: 100vh;\n    max-width: 100%;\n    overflow-x: hidden;\n  }\n  \n  #page-container {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    padding-bottom: 80px; /* Space for bottom nav */\n  }\n  \n  .page-header {\n    display: flex;\n    align-items: center;\n    margin-bottom: 20px;\n  }\n  \n  .page-header img {\n    height: 30px;\n    margin-right: 10px;\n  }\n  \n  .product-item {\n    padding: 15px;\n    margin-bottom: 10px;\n    border-radius: 8px;\n    background-color: #f8f9fa;\n    border-left: 4px solid #0095ff;\n    display: flex;\n    justify-content: space-between;\n  }\n  \n  /* Bottom navigation */\n  #bottom-nav {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    background-color: #fff;\n    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n    z-index: 100;\n  }\n  \n  .nav-btn {\n    flex: 1;\n    padding: 15px 5px;\n    border: none;\n    background: none;\n    font-size: 14px;\n    color: #666;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n  }\n  \n  .nav-btn.active {\n    color: #0095ff;\n    font-weight: bold;\n  }\n  \n  /* Popup styles */\n  .spa-popup {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0, 0, 0, 0.5);\n    display: none;\n    justify-content: center;\n    align-items: flex-end;\n    z-index: 1000;\n  }\n  \n  .popup-content {\n    background: white;\n    width: 100%;\n    max-height: 80%;\n    border-radius: 12px 12px 0 0;\n    overflow: hidden;\n    animation: slide-up 0.3s ease-out;\n  }\n  \n  .popup-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 16px;\n    border-bottom: 1px solid #eee;\n  }\n  \n  .popup-body {\n    padding: 20px;\n    overflow-y: auto;\n  }\n  \n  .close-button {\n    border: none;\n    background: none;\n    font-size: 24px;\n    cursor: pointer;\n  }\n  \n  @keyframes slide-up {\n    from { transform: translateY(100%); }\n    to { transform: translateY(0); }\n  }\n`;\ndocument.head.appendChild(styleSheet);\n\n// Route handlers\nnavigator.route('/', (_path, _data) => {\n  document.querySelector('#page-container')!.innerHTML = `\n    <div class=\"page-header\">\n      <img src=\"${viteLogo}\" alt=\"Vite logo\" />\n      <h1>Home</h1>\n    </div>\n    <p>Welcome to our mobile app example using SpaNavigator!</p>\n    \n    <h2>Featured Products</h2>\n    <div class=\"product-item\" data-product=\"Apple\">\n      <span>Apple</span>\n      <span>$1.99</span>\n    </div>\n    <div class=\"product-item\" data-product=\"Carrot\">\n      <span>Carrot</span>\n      <span>$1.49</span>\n    </div>\n    \n    <h2>Today's Special</h2>\n    <div class=\"product-item special\" data-product=\"Banana\">\n      <span>Banana</span>\n      <span>$0.99 <small>20% OFF!</small></span>\n    </div>\n    \n    <!-- New Button Added -->\n    <div style=\"margin-top: 30px; text-align: center;\">\n      <button id=\"show-random-product\" style=\"background-color: #0095ff; color: white;\">\n        Show Random Product Price\n      </button>\n    </div>\n  `;\n  \n  // Add event listener for the new button\n  document.querySelector('#show-random-product')?.addEventListener('click', () => {\n    // Get all product names from the Map\n    const products = Array.from(allProducts.keys());\n    \n    // Select a random product\n    const randomIndex = Math.floor(Math.random() * products.length);\n    const randomProduct = products[randomIndex];\n    \n    // Get its price from the Map\n    const price = allProducts?.get(randomProduct) ?? 'Price not available';\n    \n    // Display in alert\n    alert(`Random Product: ${randomProduct ?? 'Unknown Product'}\\nPrice: $${price}`);\n  });\n  \n  highlightCurrentNav('/');\n  setupProductItemListeners();\n});\n\nnavigator.route('/products', (path, data) => {\n  const productsHTML = Array.from(allProducts.entries())\n    .map(([product, price]) => `\n      <div class=\"product-item\" data-product=\"${product}\">\n        <span>${product}</span>\n        <span>$${price}</span>\n      </div>\n    `).join('');\n    \n  document.querySelector('#page-container')!.innerHTML = `\n    <div class=\"page-header\">\n      <img src=\"${typescriptLogo}\" alt=\"TypeScript logo\" />\n      <h1>Products</h1>\n    </div>\n    <p>Browse our catalog of fresh products:</p>\n    \n    <div id=\"products-list\">\n      ${productsHTML}\n    </div>\n  `;\n  \n  highlightCurrentNav('/products');\n  setupProductItemListeners();\n});\n\nnavigator.route('/about', (path, data) => {\n  document.querySelector('#page-container')!.innerHTML = `\n    <div class=\"page-header\">\n      <img src=\"${viteLogo}\" alt=\"Vite logo\" />\n      <h1>About</h1>\n    </div>\n    <p>This is a simple SPA example using custom router with history API integration.</p>\n    <p>Features demonstrated:</p>\n    <ul>\n      <li>Page navigation with history support</li>\n      <li>Mobile-friendly popup system</li>\n      <li>Map and Set usage for data management</li>\n    </ul>\n    <p>Built with Vite and TypeScript, optimized for iOS 12+</p>\n  `;\n  \n  highlightCurrentNav('/about');\n});\n\n// 404 handler\nnavigator.setNotFoundHandler((path, data) => {\n  document.querySelector('#page-container')!.innerHTML = `\n    <h1>Page Not Found</h1>\n    <p>The path \"${path}\" doesn't exist.</p>\n    <button id=\"back-home\">Back to Home</button>\n  `;\n  \n  document.querySelector('#back-home')?.addEventListener('click', () => {\n    navigator.navigate('/');\n  });\n});\n\n// Register popups\nconst productDetailsPopup: PopupHandler = {\n  element: document.querySelector('#product-details-popup') as HTMLElement,\n  onOpen: (data) => {\n    document.querySelector('#popup-product-name')!.textContent = data.name;\n    document.querySelector('#popup-product-price')!.textContent = `Price: $${data.price}`;\n  },\n  onClose: () => {\n    console.log('Product details popup closed');\n  }\n};\n\nconst settingsPopup: PopupHandler = {\n  element: document.querySelector('#settings-popup') as HTMLElement,\n  onOpen: (data) => {\n    console.log('Settings opened');\n  }\n};\n\nnavigator.registerPopup('product-details', productDetailsPopup);\nnavigator.registerPopup('settings', settingsPopup);\n\n// Setup event listeners\nfunction setupNavigation() {\n  document.querySelectorAll('.nav-btn').forEach(btn => {\n    btn.addEventListener('click', (e) => {\n      const path = (e.currentTarget as HTMLElement).dataset.path;\n      if (path) navigator.navigate(path);\n    });\n  });\n  \n  document.querySelector('#settings-btn')?.addEventListener('click', () => {\n    navigator.openPopup('settings', {});\n  });\n  \n  document.querySelectorAll('.close-button').forEach(btn => {\n    btn.addEventListener('click', () => {\n      navigator.closePopup();\n    });\n  });\n}\n\nfunction highlightCurrentNav(path: string) {\n  document.querySelectorAll('.nav-btn').forEach(btn => {\n    if ((btn as HTMLElement).dataset.path === path) {\n      btn.classList.add('active');\n    } else {\n      btn.classList.remove('active');\n    }\n  });\n}\n\nfunction setupProductItemListeners() {\n  document.querySelectorAll('.product-item').forEach(item => {\n    item.addEventListener('click', (e) => {\n      const productName = (e.currentTarget as HTMLElement).dataset.product;\n      if (productName) {\n        const price = allProducts.get(productName) || 0;\n        navigator.openPopup('product-details', { name: productName, price });\n      }\n    });\n  });\n}\n\n// Initialize the app\nsetupNavigation();\nif (document.readyState === 'complete') {\n  navigator.refresh();\n} else {\n  window.addEventListener('load', () => {\n    navigator.refresh();\n  });\n}"],"names":["SpaNavigator","options","arguments","length","undefined","_classCallCheck","this","_defineProperty","Map","window","addEventListener","handlePopState","bind","handleInitialRoute","defaultRoute","notFoundHandler","document","readyState","_createClass","key","value","route","path","handler","routes","set","setDefaultRoute","setNotFoundHandler","registerPopup","popupId","popupHandlers","navigate","data","closeAllPopups","history","pushState","type","renderCurrentPath","openPopup","has","console","error","concat","currentPath","location","pathname","url","URL","href","popupState","id","openedAt","Date","toISOString","popupStack","push","searchParams","Object","keys","btoa","JSON","stringify","popup","stack","_toConsumableArray","toString","renderPopup","closePopup","pop","back","updatePopupUI","get","onClose","depth","go","refresh","state","event","popupData","encodedData","parse","atob","e","replaceState","querySelectorAll","forEach","style","display","_history$state","onOpen","_this","index","element","zIndex","onUpdate","typescriptLogo","viteLogo","navigator","fruitPrices","veggiePricesObj","Carrot","Broccoli","Spinach","veggiePrices","entries","allProducts","body","innerHTML","styleSheet","createElement","textContent","head","appendChild","_path","_data","_document$querySelect","querySelector","_allProducts$get","products","Array","from","randomIndex","Math","floor","random","randomProduct","price","alert","highlightCurrentNav","setupProductItemListeners","productsHTML","map","_ref","_ref2","_slicedToArray","product","join","_document$querySelect2","productDetailsPopup","name","log","settingsPopup","setupNavigation","_document$querySelect3","btn","currentTarget","dataset","classList","add","remove","item","productName"],"mappings":"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"}